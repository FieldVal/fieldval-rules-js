function extend(e,i){function r(){}r.prototype=i.prototype,e.prototype=new r,e.prototype.constructor=e,e.superConstructor=i,e.superClass=i.prototype}function FVRuleEditor(e,i){var r=this;r.base_fields={},FVRuleEditor.superConstructor.call(this,e,i);var t=[],n=FVRule.FVRuleField.types;for(var l in n)if(n.hasOwnProperty(l)){var a=n[l],e=l,d=a.display_name;t.push(d?[e,d]:e)}r.add_field("name",new FVTextField("Name")),r.add_field("display_name",new FVTextField("Display Name")),r.add_field("type",new FVChoiceField("Type",{choices:t}).on_change(function(){r.update_type_fields()}));for(var e in r.fields)r.fields.hasOwnProperty(e)&&(r.base_fields[e]=!0);r.update_type_fields()}"undefined"!=typeof module&&(module.exports=extend);var FVRuleField=function(){function e(e,i){var n=this;if(n.json=e,n.checks=[],n.validator="undefined"!=typeof i?i:new r(e),n.name=n.validator.get("name",t.string(!1)),n.display_name=n.validator.get("display_name",t.string(!1)),n.description=n.validator.get("description",t.string(!1)),n.type=n.validator.get("type",t.string(!0)),n.required=n.validator.get("required",t["boolean"](!1)),void 0===n.required&&(n.required=!0),null!=e){var l=n.validator.get("exists",t["boolean"](!1));null!=l&&(existsFilter=l?1:2)}}var i;if(void 0!==this.FieldVal)i=this.FieldVal;else{if("function"!=typeof require)throw new Error("FieldVal Rules requires FieldVal");i=require("fieldval")}var r=i,t=r.BasicVal;return e.errors={interval_conflict:function(e,i){return{error:501,error_message:"Only one interval can be used.",interval:e,existing:i}},index_already_present:function(){return{error:502,error_message:"Index already present."}},invalid_indices_format:function(){return{error:503,error_message:"Invalid format for an indices rule."}},incomplete_indicies:function(e){var i={error:504,error_message:"Incomplete indices pattern"};return void 0!==e&&(i.missing=e),i},any_and_fields:function(){return{error:505,error_message:"'any' can't be used with 'fields'."}},max_length_not_greater_than_min_length:function(){return{error:506,error_message:"Must be greater than or equal to the minimum length"}},maximum_not_greater_than_minimum:function(){return{error:507,error_message:"Must be greater than or equal to the minimum"}}},e.types={},e.add_field_type=function(i){e.types[i.name]={display_name:i.display_name,"class":i["class"]}},e.create_field=function(i,n){var l=null,a=t.object(!0).check(i);if(a)return[a,null];var d=new r(i),o=[t.string(!1)];n&&(void 0!==n.need_name&&n.need_name===!0&&o.push(t.string(!0)),void 0!==n.allow_dots&&n.allow_dots===!1&&o.push(t.does_not_contain(["."])),n.existing_names&&o.push(t.not_one_of(n.existing_names,{error:{error:1e3,error_message:"Name already used"}}))),d.get("name",o);var u=d.get("type",t.string(!0),t.one_of(e.types));if(!u)return[d.end(),null];var s=e.types[u],f=s["class"];l=new f(i,d);var c=l.init();return null!=c?[c,null]:[null,l]},e.prototype.validate_as_field=function(e,i){var r=this;i.get_async(e,r.checks)},e.prototype.validate=function(e,i){var t=this;if(!i)throw new Error("No callback specified");return r.use_checks(e,t.checks,{},function(e){i(e)})},e.prototype.make_nested=function(){},e.prototype.init=function(){},e.prototype.remove=function(){},e.prototype.view_mode=function(){},e.prototype.edit_mode=function(){},e.prototype.change_name=function(){},e.prototype.disable=function(){},e.prototype.enable=function(){},e.prototype.focus=function(){},e.prototype.blur=function(){},e.prototype.val=function(){},e}.call("undefined"!=typeof window?window:null);"undefined"!=typeof module&&(module.exports=FVRuleField);var FVBasicRuleField=function(){function e(i,r){e.superConstructor.call(this,i,r)}var i;if(void 0!==this.FVRuleField)i=this.FVRuleField;else{if("function"!=typeof require)throw new Error("FVRuleField is missing");i=require("./FVRuleField")}var r;if(void 0!==this.extend)r=this.extend;else{if("function"!=typeof require)throw new Error("extend() is missing");r=require("extend")}var t=r,n=i;return t(e,n),e.prototype.init=function(){var e=this;return e.ui_field.init.apply(e.ui_field,arguments)},e.prototype.remove=function(){var e=this;return e.ui_field.remove.apply(e.ui_field,arguments)},e.prototype.in_array=function(){var e=this;return e.ui_field.in_array.apply(e.ui_field,arguments)},e.prototype.in_key_value=function(){var e=this;return e.ui_field.in_key_value.apply(e.ui_field,arguments)},e.prototype.change_name=function(){var e=this;return e.ui_field.change_name.apply(e.ui_field,arguments)},e.prototype.disable=function(){var e=this;return e.ui_field.disable.apply(e.ui_field,arguments)},e.prototype.enable=function(){var e=this;return e.ui_field.enable.apply(e.ui_field,arguments)},e.prototype.name_val=function(){var e=this;return e.ui_field.name_val.apply(e.ui_field,arguments)},e.prototype.val=function(){var e=this;return e.ui_field.val.apply(e.ui_field,arguments)},e.prototype.error=function(){var e=this;return e.ui_field.error.apply(e.ui_field,arguments)},e.prototype.blur=function(){var e=this;return e.ui_field.blur.apply(e.ui_field,arguments)},e.prototype.focus=function(){var e=this;return e.ui_field.blur.apply(e.ui_field,arguments)},e}.call("undefined"!=typeof window?window:null);"undefined"!=typeof module&&(module.exports=FVBasicRuleField);var FVTextRuleField=function(){function e(i,r){e.superConstructor.call(this,i,r)}var i;if(void 0!==this.FieldVal)i=this.FieldVal;else{if("function"!=typeof require)throw new Error("FieldVal Rules requires FieldVal");i=require("fieldval")}var r,t=i,n=t.BasicVal;if(void 0!==this.FVRuleField)r=this.FVBasicRuleField;else{if("function"!=typeof require)throw new Error("FVBasicRuleField is missing");r=require("./FVBasicRuleField")}var l,a=r;if(void 0!==this.FVRuleField)l=this.FVRuleField;else{if("function"!=typeof require)throw new Error("FVRuleField is missing");l=require("./FVRuleField")}var d,o=l;if(void 0!==this.extend)d=this.extend;else{if("function"!=typeof require)throw new Error("extend() is missing");d=require("extend")}var u=d;return u(e,a),e.prototype.create_ui=function(e){var i=this;return i.ui_field=new FVTextField(i.display_name||i.name,{name:i.name,display_name:i.display_name,type:i.ui_type,form:e}),i.element=i.ui_field.element,i.ui_field},e.prototype.init=function(){var e=this;return e.checks.push(n.string(e.required)),e.min_length=e.validator.get("min_length",n.integer(!1),n.minimum(0)),void 0!==e.min_length&&e.checks.push(n.min_length(e.min_length,{stop_on_error:!1})),e.max_length=e.validator.get("max_length",n.integer(!1),n.minimum(0),function(i){return void 0!==e.min_length&&i<e.min_length?o.errors.max_length_not_greater_than_min_length():void 0}),void 0!==e.max_length&&e.checks.push(n.max_length(e.max_length,{stop_on_error:!1})),e.ui_type=e.validator.get("ui_type",n.string(!1),n.one_of(["text","textarea","password"])),e.validator.end()},e.add_editor_params=function(e){e.add_field("min_length",new FVTextField("Minimum Length",{type:"number"})),e.add_field("max_length",new FVTextField("Maximum Length",{type:"number"}));var i=new FVChoiceField("UI Type",{choices:["text","textarea","password"]});e.add_field("ui_type",i);var r=e.val();e.fields.min_length.val(r.min_length),e.fields.max_length.val(r.max_length),e.fields.ui_type.val(r.ui_type)},e}.call("undefined"!=typeof window?window:null);"undefined"!=typeof module&&(module.exports=FVTextRuleField);var FVNumberRuleField=function(){function e(i,r){e.superConstructor.call(this,i,r)}var i;if(void 0!==this.FieldVal)i=this.FieldVal;else{if("function"!=typeof require)throw new Error("FieldVal Rules requires FieldVal");i=require("fieldval")}var r,t=i,n=t.BasicVal;if(void 0!==this.FVRuleField)r=this.FVBasicRuleField;else{if("function"!=typeof require)throw new Error("FVBasicRuleField is missing");r=require("./FVBasicRuleField")}var l,a=r;if(void 0!==this.FVRuleField)l=this.FVRuleField;else{if("function"!=typeof require)throw new Error("FVRuleField is missing");l=require("./FVRuleField")}var d;if(void 0!==this.extend)d=this.extend;else{if("function"!=typeof require)throw new Error("extend() is missing");d=require("extend")}var o=d;return o(e,a),e.prototype.create_ui=function(){var e=this;return e.ui_field=new FVTextField(e.display_name||e.name,e.json),e.element=e.ui_field.element,e.ui_field},e.prototype.init=function(){var e=this;return e.checks.push(n.number(e.required)),e.minimum=e.validator.get("minimum",n.number(!1)),null!=e.minimum&&e.checks.push(n.minimum(e.minimum,{stop_on_error:!1})),e.maximum=e.validator.get("maximum",n.number(!1)),null!=e.maximum&&e.checks.push(n.maximum(e.maximum,{stop_on_error:!1})),e.integer=e.validator.get("integer",n["boolean"](!1)),e.integer&&e.checks.push(n.integer(!1,{stop_on_error:!1})),e.validator.end()},e.add_editor_params=function(e){e.add_field("minimum",new FVTextField("Minimum",{type:"number"})),e.add_field("maximum",new FVTextField("Maximum",{type:"number"})),e.add_field("integer",new FVBooleanField("Integer"));var i=e.val();e.fields.minimum.val(i.minimum),e.fields.maximum.val(i.maximum),e.fields.integer.val(i.integer)},e}.call("undefined"!=typeof window?window:null);"undefined"!=typeof module&&(module.exports=FVNumberRuleField);var FVObjectRuleField=function(){function e(i,r){e.superConstructor.call(this,i,r)}var i;if(void 0!==this.FieldVal)i=this.FieldVal;else{if("function"!=typeof require)throw new Error("FieldVal Rules requires FieldVal");i=require("fieldval")}var r,t=i,n=t.BasicVal;if(void 0!==this.FVRuleField)r=this.FVBasicRuleField;else{if("function"!=typeof require)throw new Error("FVBasicRuleField is missing");r=require("./FVBasicRuleField")}var l,a=r;if(void 0!==this.FVRuleField)l=this.FVRuleField;else{if("function"!=typeof require)throw new Error("FVRuleField is missing");l=require("./FVRuleField")}var d,o=l;if(void 0!==this.extend)d=this.extend;else{if("function"!=typeof require)throw new Error("extend() is missing");d=require("extend")}var u=d;return u(e,a),e.prototype.create_ui=function(e){var i=this;if(i.any)if(i.field_type){i.ui_field=new FVKeyValueField(i.display_name||i.name,{form:e}),i.element=i.ui_field.element,i.ui_field.new_field=function(e){return i.new_field(e)};var r=i.ui_field.remove_field;i.ui_field.remove_field=function(e){for(var t=0;t<i.fields.length;t++)i.fields[t]===e&&i.fields.splice(t,1);return r.call(i.ui_field,e)}}else i.ui_field=new FVTextField(i.display_name||i.name,{type:"textarea",form:e}),i.ui_field.val=function(e){var i=this;if(0===arguments.length){var r=i.input.val();if(0===r.length)return null;try{return JSON.parse(r)}catch(t){console.error("FAILED TO PARSE: ",r)}return r}return i.input.val(JSON.stringify(e,null,4)),i},i.element=i.ui_field.element;else{i.ui_field=new FVObjectField(i.display_name||i.name,{form:e});for(var t in i.fields){var n=i.fields[t],l=n.create_ui();i.ui_field.add_field(n.name,l)}i.element=i.ui_field.element}return i.ui_field},e.add_editor_params=function(e){var i=new FVArrayField("Fields");i.new_field=function(){var r=new e.constructor(null,e);i.add_field(null,r)};var r=new FVBooleanField("Any");r.on_change(function(r){r?e.remove_field("fields"):e.add_field("fields",i)}),e.add_field("any",r);var t=e.val();r.val(t.any);var n=t.fields;if(n)for(var l=0;l<t.fields.length;l++){var a=t.fields[l],d=new e.constructor(a,e);i.add_field(null,d)}},e.prototype.new_field=function(){var e=this,i=o.create_field(e.field_type.json),r=(i[0],i[1]);return r.create_ui()},e.prototype.init=function(){var e=this;e.checks.push(n.object(e.required)),e.fields={};var i=e.validator.get("fields",n.array(!1));if(null!=i){for(var r=new t(null),l=0;l<i.length;l++){var a=i[l],d=o.create_field(a,{need_name:!0,existing_names:e.fields}),u=d[0],s=d[1];null==u?e.fields[s.name]=s:r.invalid(l,u)}var f=r.end();null!=f?e.validator.invalid("fields",f):e.checks.push(function(i,r,n){var l=new t(i);for(var a in e.fields){var d=e.fields[a];d.validate_as_field(a,l)}return l.end(function(e){n(e)})})}return e.any=e.validator.get("any",n["boolean"](!1)),e.any?void 0!==i&&e.validator.invalid("any",o.errors.any_and_fields()):void 0===i&&e.checks.push(function(e,i,r){var n=new t(e);return n.end(function(e){r(e)})}),e.validator.end()},e}.call("undefined"!=typeof window?window:null);"undefined"!=typeof module&&(module.exports=FVObjectRuleField);var FVArrayRuleField=function(){function e(i,r){var t=this;e.superConstructor.call(this,i,r),t.rules=[],t.fields=[],t.indices={},t.interval=null,t.interval_offsets=[]}var i;if(void 0!==this.FieldVal)i=this.FieldVal;else{if("function"!=typeof require)throw new Error("FieldVal Rules requires FieldVal");i=require("fieldval")}var r,t=i,n=t.BasicVal;if(void 0!==this.FVRuleField)r=this.FVBasicRuleField;else{if("function"!=typeof require)throw new Error("FVBasicRuleField is missing");r=require("./FVBasicRuleField")}var l,a=r;if(void 0!==this.FVRuleField)l=this.FVRuleField;else{if("function"!=typeof require)throw new Error("FVRuleField is missing");l=require("./FVRuleField")}var d,o=l;if(void 0!==this.extend)d=this.extend;else{if("function"!=typeof require)throw new Error("extend() is missing");d=require("extend")}var u=d;return u(e,a),e.prototype.create_ui=function(){var e=this;e.ui_field=new FVArrayField(e.display_name||e.name,e.json),e.ui_field.new_field=function(i){return e.new_field(i)};var i=e.ui_field.remove_field;return e.ui_field.remove_field=function(r){for(var t=0;t<e.fields.length;t++)e.fields[t]===r&&e.fields.splice(t,1);return i.call(e.ui_field,r)},e.element=e.ui_field.element,e.ui_field},e.prototype.new_field=function(e){var i=this,r=i.rule_for_index(e);return r.create_ui()},e.prototype.rule_for_index=function(e){var i=this,r=i.rules[e];if(!r){{var t=i.rule_json_for_index(e),n=o.create_field(t);n[0]}r=n[1],i.rules[e]=r}return r},e.prototype.rule_json_for_index=function(e){var i=this,r=i.indices[e];if(!r&&i.interval){var t=e%i.interval;r=i.interval_offsets[t]}return r||(r=i.indices["*"]),r},e.integer_regex=/^(\d+)$/,e.interval_regex=/^(\d+)n(\+(\d+))?$/,e.prototype.init=function(){var i=this;i.checks.push(n.array(i.required)),i.min_length=i.validator.get("min_length",n.integer(!1),n.minimum(0)),void 0!==i.min_length&&i.checks.push(n.min_length(i.min_length,{stop_on_error:!1})),i.max_length=i.validator.get("max_length",n.integer(!1),n.minimum(0),function(e){return void 0!==i.min_length&&e<i.min_length?o.errors.max_length_not_greater_than_min_length():void 0}),void 0!==i.max_length&&i.checks.push(n.max_length(i.max_length,{stop_on_error:!1}));var r=i.validator.get("indices",n.object(!1));if(null!=r){var l=new t(null);for(var a in r){var d=r[a],u=o.create_field(d),s=u[0];if(null==s){var f=a.match(e.interval_regex);if(f){var c=f[1],p=f[3]||0;if(i.interval&&c!==i.interval){l.invalid(a,o.errors.interval_conflict(c,i.interval));continue}i.interval=c,void 0!==i.interval_offsets[p]&&l.invalid(a,o.errors.index_already_present()),i.interval_offsets[p]=d}else{var _=a.match(e.integer_regex);if(_){var m=_[1];i.indices[m]=d}else"*"===a?i.indices["*"]=d:l.invalid(a,o.errors.invalid_indices_format)}}else l.invalid(a,s)}var v=l.end();if(v)i.validator.invalid("indices",v);else if(!i.indices["*"]){var F=[];if(void 0!==i.max_length)for(var h=0;h<i.max_length;h++)i.rule_json_for_index(h)||F.push(h);else if(i.interval)for(var h=0;h<i.interval;h++)void 0===i.interval_offsets[h]&&F.push(i.interval+"n"+(0===h?"":"+"+h));else i.validator.invalid("indices",o.errors.incomplete_indicies());F.length>0&&i.validator.invalid("indices",o.errors.incomplete_indicies(F))}}return i.checks.push(function(e){for(var r=new t(e),n=0;n<e.length;n++){var l=i.rule_for_index(n);l.validate_as_field(n,r)}var a=r.end();return a}),i.validator.end()},e.add_editor_params=function(e){var i=e.val(),r=new FVKeyValueField("Indices");r.new_field=function(){return new e.constructor(null,e)},r.val(i.indices),e.add_field("indices",r)},e}.call("undefined"!=typeof window?window:null);"undefined"!=typeof module&&(module.exports=FVArrayRuleField);var FVChoiceRuleField=function(){function e(i,r){e.superConstructor.call(this,i,r)}var i;if(void 0!==this.FieldVal)i=this.FieldVal;else{if("function"!=typeof require)throw new Error("FieldVal Rules requires FieldVal");i=require("fieldval")}var r,t=i,n=t.BasicVal;if(void 0!==this.FVRuleField)r=this.FVBasicRuleField;else{if("function"!=typeof require)throw new Error("FVBasicRuleField is missing");r=require("./FVBasicRuleField")}var l,a=r;if(void 0!==this.FVRuleField)l=this.FVRuleField;else{if("function"!=typeof require)throw new Error("FVRuleField is missing");l=require("./FVRuleField")}var d;if(void 0!==this.extend)d=this.extend;else{if("function"!=typeof require)throw new Error("extend() is missing");d=require("extend")}var o=d;return o(e,a),e.prototype.create_ui=function(){var e=this;return e.json.choices=e.choices,e.ui_field=new FVChoiceField(e.display_name||e.name,e.json),e.element=e.ui_field.element,e.ui_field},e.prototype.init=function(){var e=this;return e.allow_empty=e.validator.get("allow_empty",n["boolean"](!1)),e.empty_message=e.validator.get("empty_message",n.string(!1)),e.choices=e.validator.get("choices",n.array(!0)),void 0!==e.choices&&e.checks.push(n.one_of(e.choices,{stop_on_error:!1})),e.validator.end()},e.add_editor_params=function(e){var i=e.val(),r=new FVObjectField("Choices"),t=0,n=function(){t+=1;var e=new FVArrayField;return e.id=t,e.new_field=function(){if("simple"==l.val())return new FVTextField("Value");var e=new FVArrayField("",{hide_remove_button:!0,hide_add_button:!0,sortable:!1});return e.add_field(new FVTextField("Value")),e.add_field(new FVTextField("Display name")),e},e.val=function(e,i){var r=this;if(e){for(var t=[],n=0;n<e.length;n++){var a=e[n];t.push("simple"==l.val()?Array.isArray(a)?a[0]:a:Array.isArray(a)?a:[a,a])}return FVArrayField.prototype.val.call(r,t,i)}for(var d=FVArrayField.prototype.val.apply(r,arguments),t=[],n=0;n<d.length;n++){var o=d[n];t.push(Array.isArray(o)&&o[0]==o[1]?o[0]:o)}return t},e},l=new FVChoiceField("Mode",{choices:["simple","advanced"]}).on_change(function(){var e=[];r.fields.choices&&(e=r.fields.choices.val()),r.remove_field("choices");var i=n();r.add_field("choices",i),i.val(e)});r.add_field("mode",l),r.update_mode=function(e){var i=!0;if(e)for(var r=0;r<e.length;r++)if(Array.isArray(e[r])){i=!1;break}l.val(i?"simple":"advanced")},r.val=function(){arguments.length>0&&arguments[0]&&r.update_mode(arguments[0]);var e=r.fields.choices;return e.val.apply(e,arguments)},r.update_mode(i.choices),r.val(i.choices),e.add_field("choices",r),e.add_field("allow_empty",new FVBooleanField("Allow empty")),e.add_field("empty_message",new FVTextField("Empty message")),e.fields.allow_empty.val(i.allow_empty),e.fields.empty_message.val(i.empty_message)},e}.call("undefined"!=typeof window?window:null);"undefined"!=typeof module&&(module.exports=FVChoiceRuleField);var FVBooleanRuleField=function(){function e(i,r){e.superConstructor.call(this,i,r)}var i;if(void 0!==this.FieldVal)i=this.FieldVal;else{if("function"!=typeof require)throw new Error("FieldVal Rules requires FieldVal");i=require("fieldval")}var r,t=i,n=t.BasicVal;if(void 0!==this.FVRuleField)r=this.FVBasicRuleField;else{if("function"!=typeof require)throw new Error("FVBasicRuleField is missing");r=require("./FVBasicRuleField")}var l,a=r;if(void 0!==this.FVRuleField)l=this.FVRuleField;else{if("function"!=typeof require)throw new Error("FVRuleField is missing");l=require("./FVRuleField")}var d;if(void 0!==this.extend)d=this.extend;else{if("function"!=typeof require)throw new Error("extend() is missing");d=require("extend")}var o=d;return o(e,a),e.prototype.create_ui=function(){var e=this;return e.ui_field=new FVBooleanField(e.display_name||e.name,e.json),e.element=e.ui_field.element,e.ui_field},e.prototype.init=function(){var e=this;return e.checks.push(n["boolean"](e.required)),e.equal_to=e.validator.get("equal_to",n["boolean"](!1)),void 0!==e.equal_to&&e.checks.push(n.equal_to(e.equal_to)),e.validator.end()},e.add_editor_params=function(e){e.add_field("equal_to",new FVChoiceField("Equal to",{choices:[!0,!1]}));var i=e.val();e.fields.equal_to.val(i.equal_to)},e}.call("undefined"!=typeof window?window:null);"undefined"!=typeof module&&(module.exports=FVBooleanRuleField);var FVEmailRuleField=function(){function e(i,r){e.superConstructor.call(this,i,r)}var i;if(void 0!==this.FieldVal)i=this.FieldVal;else{if("function"!=typeof require)throw new Error("FieldVal Rules requires FieldVal");i=require("fieldval")}var r,t=i,n=t.BasicVal;if(void 0!==this.FVRuleField)r=this.FVBasicRuleField;else{if("function"!=typeof require)throw new Error("FVBasicRuleField is missing");r=require("./FVBasicRuleField")}var l,a=r;if(void 0!==this.FVRuleField)l=this.FVRuleField;else{if("function"!=typeof require)throw new Error("FVRuleField is missing");l=require("./FVRuleField")}var d;if(void 0!==this.extend)d=this.extend;else{if("function"!=typeof require)throw new Error("extend() is missing");d=require("extend")}var o=d;return o(e,a),e.prototype.create_ui=function(){var e=this;return e.ui_field=new FVTextField(e.display_name||e.name,e.json),e.element=e.ui_field.element,e.ui_field},e.prototype.init=function(){var e=this;return e.checks.push(n.string(e.required),n.email()),e.validator.end()},e}.call("undefined"!=typeof window?window:null);"undefined"!=typeof module&&(module.exports=FVEmailRuleField);var FVDateRuleField=function(){function e(i,r){e.superConstructor.call(this,i,r)}var i;if(void 0!==this.FieldVal)i=this.FieldVal;else{if("function"!=typeof require)throw new Error("FieldVal Rules requires FieldVal");i=require("fieldval")}var r,t=i,n=t.BasicVal;if(void 0!==this.FVRuleField)r=this.FVBasicRuleField;else{if("function"!=typeof require)throw new Error("FVBasicRuleField is missing");r=require("./FVBasicRuleField")}var l,a=r;if(void 0!==this.FVRuleField)l=this.FVRuleField;else{if("function"!=typeof require)throw new Error("FVRuleField is missing");l=require("./FVRuleField")}var d;if(void 0!==this.extend)d=this.extend;else{if("function"!=typeof require)throw new Error("extend() is missing");d=require("extend")}var o=d;return o(e,a),e.prototype.create_ui=function(){var e=this;return e.ui_field=new FVDateField(e.display_name||e.name,{name:e.json.name,display_name:e.json.display_name,format:e.date_format}),e.element=e.ui_field.element,e.ui_field},e.prototype.init=function(){var e=this;return e.date_format=e.validator.get("format",n.string(!0),n.date_format({emit:t.DateVal.EMIT_STRING})),void 0!==e.date_format&&e.checks.push(n.date(e.date_format)),e.validator.end()},e.add_editor_params=function(e){e.add_field("format",new FVTextField("Date format"));var i=e.val();e.fields.format.val(i.format)},e}.call("undefined"!=typeof window?window:null);"undefined"!=typeof module&&(module.exports=FVDateRuleField);var FVRule=function(){function e(){}var i;if(void 0!==this.FieldVal)i=this.FieldVal;else{if("function"!=typeof require)throw new Error("FieldVal Rules requires FieldVal");i=require("fieldval")}{var r,t=i;t.BasicVal}if(void 0!==this.FVRuleField)r=this.FVRuleField;else{if("function"!=typeof require)throw new Error("FVRuleField is missing");r=require("./fields/FVRuleField")}var n=r;return e.FVRuleField=n,e.prototype.init=function(e,i){var r=this,t=n.create_field(e,i);return t[0]?t[0]:(r.field=t[1],null)},e.prototype.create_form=function(){var e=this;return e.create_ui(!0)},e.prototype.create_ui=function(e){var i=this;return i.field.create_ui(e)},e.prototype.validate=function(){var e=this;return e.field.validate.apply(e.field,arguments)},e.prototype.check=function(e,i,r){var t=this;t.field.validate(e,function(e){r(e)})},n.add_field_type({name:"text",display_name:"Text","class":"undefined"!=typeof FVTextRuleField?FVTextRuleField:require("./fields/FVTextRuleField")}),n.add_field_type({name:"string",display_name:"String","class":"undefined"!=typeof FVTextRuleField?FVTextRuleField:require("./fields/FVTextRuleField")}),n.add_field_type({name:"boolean",display_name:"Boolean","class":"undefined"!=typeof FVBooleanRuleField?FVBooleanRuleField:require("./fields/FVBooleanRuleField")}),n.add_field_type({name:"number",display_name:"Number","class":"undefined"!=typeof FVNumberRuleField?FVNumberRuleField:require("./fields/FVNumberRuleField")}),n.add_field_type({name:"object",display_name:"Object","class":"undefined"!=typeof FVObjectRuleField?FVObjectRuleField:require("./fields/FVObjectRuleField")}),n.add_field_type({name:"array",display_name:"Array","class":"undefined"!=typeof FVArrayRuleField?FVArrayRuleField:require("./fields/FVArrayRuleField")}),n.add_field_type({name:"choice",display_name:"Choice","class":"undefined"!=typeof FVChoiceRuleField?FVChoiceRuleField:require("./fields/FVChoiceRuleField")}),n.add_field_type({name:"email",display_name:"Email","class":"undefined"!=typeof FVEmailRuleField?FVEmailRuleField:require("./fields/FVEmailRuleField")}),n.add_field_type({name:"date",display_name:"Date","class":"undefined"!=typeof FVDateRuleField?FVDateRuleField:require("./fields/FVDateRuleField")}),e}.call("undefined"!=typeof window?window:null);"undefined"!=typeof module&&(module.exports=FVRule),fieldval_ui_extend(FVRuleEditor,FVForm),FVRuleEditor.prototype.update_type_fields=function(e){var i=this,r=i.fields.type.val();for(var t in i.fields)i.base_fields[t]||i.fields[t].remove();if(r){var n=FVRule.FVRuleField.types[r]["class"];void 0!==n.add_editor_params&&n.add_editor_params(i,e)}},FVRuleEditor.prototype.val=function(e){var i=this;return e&&(i.fields.type.val(e.type,{ignore_change:!0}),i.update_type_fields(e),delete e.type),FVForm.prototype.val.apply(i,arguments)};